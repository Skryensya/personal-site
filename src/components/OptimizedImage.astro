---
import { Image } from 'astro:assets';

export interface Props {
    src: string | ImageMetadata;
    alt: string;
    width?: number;
    height?: number;
    class?: string;
    loading?: 'lazy' | 'eager';
    sizes?: string;
    decoding?: 'async' | 'sync' | 'auto';
}

const { 
    src, 
    alt, 
    width, 
    height, 
    class: className, 
    loading = 'lazy',
    sizes,
    decoding = 'async',
    ...props 
} = Astro.props;

// Define responsive sizes for better loading
const defaultSizes = sizes || '(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw';
---

<Image
    src={src}
    alt={alt}
    width={width}
    height={height}
    class={className}
    loading={loading}
    sizes={defaultSizes}
    decoding={decoding}
    style={{
        // Prevent layout shift with explicit dimensions
        aspectRatio: width && height ? `${width} / ${height}` : undefined,
    }}
    {...props}
/>