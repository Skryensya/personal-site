---
import { ViewTransitions } from 'astro:transitions';
import BaseHead, { type Props as HeadProps } from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import TerminalFooter from '../components/TerminalFooter.astro'; 

export type Props = HeadProps & { showHeader?: boolean; headerTitle?: string, headerSubtitle?: string };

const { showHeader = true, headerTitle = null, headerSubtitle = null,  ...head } = Astro.props;
---

<!doctype html>
<html lang="en" class="antialiased break-words">
    <head>
        <BaseHead {...head} />
        <script>
            // Fast theme initialization with validation
            const validThemes = ['void', 'phantom', 'azure', 'ember', 'violet'];
            
            function applyTheme(themeId: any, isDark: any) {
                document.documentElement.setAttribute('data-theme', themeId);
                document.documentElement.classList.toggle('dark', isDark);
            }

            // Load and apply saved theme with validation
            function initializeTheme() {
                try {
                    const savedMode = localStorage.getItem('theme-mode') || 'light';
                    const savedTheme = localStorage.getItem('theme-id') || 'void';
                    
                    // Validate theme exists in current theme list
                    const theme = validThemes.includes(savedTheme) ? savedTheme : 'void';
                    
                    applyTheme(theme, savedMode === 'dark');
                    
                    // Update localStorage if theme was invalid
                    if (theme !== savedTheme) {
                        localStorage.setItem('theme-id', theme);
                    }
                } catch (e) {
                    // Fallback if localStorage fails
                    applyTheme('void', false);
                }
            }
            
            // Initialize theme
            initializeTheme();
        </script>
        <script src="/as-dithered-image.js" is:inline></script>
        <ViewTransitions />
    </head>
    <body class="bg-secondary text-main md:px-10 (--max-w-size:1280px) max-w-[var(--max-w-size)] mx-auto  relative">
 
        <Header />
     <div class="mt-8 ">  
        <main class="text-left px-4">
                <slot />
            </main>
        </div>
        <TerminalFooter />
    </body>
</html>
