---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import Button from '../components/Button.astro';
import TextGenerateEffect from '../components/TextGenerateEffect.astro';
import siteConfig from '../data/site-config';
import { sortItemsByDateDesc } from '../utils/data-utils';

const projects = (await getCollection('projects')).sort(sortItemsByDateDesc);
const featuredProjects = projects.filter(({ data }) => data.isFeatured);

const skills = ["React", "TypeScript", "Node.js", "Astro", "PostgreSQL", "AWS"];
---

<BaseLayout description={siteConfig.description} image={siteConfig.image}>
    <!-- Hero Section -->
    <section class="py-20">
        <div class="max-w-4xl mx-auto px-6">
            <h1 class="text-4xl md:text-5xl font-bold text-main mb-4">
                Hola, soy Allison
            </h1>
            <div class="mb-8">
                <TextGenerateEffect words="Me gusta crear sitios web que funcionen bien y sean f√°ciles de usar. Trabajo principalmente con React y TypeScript." />
            </div>
            <div>
                <Button href="/projects" type="cta" size="medium">
                    Ver mis proyectos
                </Button>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section class="py-20 border-t border-main/20">
        <div class="max-w-4xl mx-auto px-6">
            <h2 class="text-2xl font-semibold text-main mb-6">
                Un poco sobre m√≠
            </h2>
            <div class="space-y-4 text-main/70">
                <p>
                    Llevo unos 4 a√±os haciendo sitios web. Me encanta cuando las cosas funcionan bien 
                    y son accesibles para todos. Uso mucho React, TypeScript y Node.js.
                </p>
                <p>
                    Ahora trabajo en Asimov Consultores haciendo aplicaciones web. Tambi√©n ayudo 
                    a otros developers m√°s nuevos cuando puedo.
                </p>
                <p>
                    Cuando no estoy programando me gusta jugar ajedrez, tomar fotos y aprender idiomas. 
                    Ahora mismo estoy con el noruego (est√° dif√≠cil üòÖ).
                </p>
            </div>
        </div>
    </section>

    <!-- Skills Section -->
    <section class="py-20 border-t border-main/20">
        <div class="max-w-4xl mx-auto px-6">
            <h2 class="text-2xl font-semibold text-main mb-6">
                Con qu√© trabajo
            </h2>
            <div class="flex flex-wrap gap-3">
                {skills.map((skill) => (
                    <span class="skill-tag px-3 py-1 text-sm bg-muted text-main rounded relative overflow-hidden cursor-pointer">
                        <span class="relative z-10">{skill}</span>
                    </span>
                ))}
            </div>
        </div>
    </section>

    <!-- Experience Section -->
    <section class="py-20 border-t border-main/20">
        <div class="max-w-4xl mx-auto px-6">
            <h2 class="text-2xl font-semibold text-main mb-6">
                D√≥nde he trabajado
            </h2>
            <div class="space-y-6">
                <div>
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-1">
                        <h3 class="text-lg font-medium text-main">Desarrollador Senior</h3>
                        <span class="text-sm text-main/60">2022 - ahora</span>
                    </div>
                    <p class="text-main/60 mb-2">Asimov Consultores</p>
                    <p class="text-main/70">
                        Hago aplicaciones web con React y Node.js. Tambi√©n ayudo al equipo 
                        con c√≥digo y a veces explico cosas a los developers nuevos.
                    </p>
                </div>
                <div>
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-1">
                        <h3 class="text-lg font-medium text-main">Freelancer</h3>
                        <span class="text-sm text-main/60">2020 - 2022</span>
                    </div>
                    <p class="text-main/70">
                        Hac√≠a sitios web para empresas peque√±as. Me gustaba mucho que fueran 
                        r√°pidos y que todos los pudieran usar.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Projects -->
    {featuredProjects?.length > 0 && (
        <section class="py-20 border-t border-main/20">
            <div class="max-w-4xl mx-auto px-6">
                <h2 class="text-2xl font-semibold text-main mb-6">
                    Algunos proyectos
                </h2>
                <div class="space-y-6">
                    {featuredProjects.map((project) => (
                        <div class="project-card border border-main/20 rounded-lg p-4 relative overflow-hidden cursor-pointer">
                            <div class="relative z-10">
                                <h3 class="text-lg font-medium text-main mb-2">{project.data.title}</h3>
                                <p class="text-main/70 mb-3">{project.data.description}</p>
                                <a href={`/projects/${project.slug}`} class="text-main hover:underline text-sm">
                                    Ver m√°s ‚Üí
                                </a>
                            </div>
                        </div>
                    ))}
                </div>
                <div class="mt-6">
                    <Button href="/projects" type="accent" size="small">
                        Ver todos ‚Üí
                    </Button>
                </div>
            </div>
        </section>
    )}
</BaseLayout>

<style>
    /* Skill tags circular expansion */
    .skill-tag::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: rgb(var(--color-text-main) / 0.1);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        transition: width 0.4s ease, height 0.4s ease;
        z-index: 1;
    }

    .skill-tag:hover::before {
        width: 80px;
        height: 80px;
    }

    /* Project cards circular expansion */
    .project-card::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: rgb(var(--color-text-main) / 0.05);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        transition: width 0.8s ease, height 0.8s ease;
        z-index: 1;
    }

    .project-card:hover::before {
        width: 400px;
        height: 400px;
    }
</style>