---
import { getCollection } from 'astro:content';
import { sortItemsByDateDesc } from '../../../utils/data-utils';
import ProjectsPage from '@/components/pages/ProjectsPage.astro';

export async function getStaticPaths() {
    const allProjects = await getCollection('projects');
    const lang = 'en';

    const projectsInLang = allProjects
        .filter(project => project.id.startsWith(`${lang}/`))
        .sort(sortItemsByDateDesc);

    return [{
        params: { page: undefined },
        props: { projects: projectsInLang }
    }];
}

const { projects } = Astro.props;

// Redirect to home with anchor if flag is NOT enabled
if (import.meta.env.PUBLIC_ENABLE_PROJECT_PAGES !== 'true') {
    return Astro.redirect('/en/#projects');
}
---

<ProjectsPage lang="en" projects={projects} />
