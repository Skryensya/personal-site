---
import { getStaticPaths } from 'astro';
import { getLangFromUrl, useTranslations } from '@/i18n/utils';
import { supportedLanguages, type Language } from '@/i18n/ui';

export async function getStaticPaths() {
    return supportedLanguages
        .filter(lang => lang !== 'es') // Default locale handled by /cv
        .map(lang => ({
            params: { lang },
            props: { lang }
        }));
}

interface Props {
    lang: Language;
}

const { lang } = Astro.props;
const t = useTranslations(lang);

// ATS-friendly keywords (invisible but searchable)
const atsKeywords = [
    'React Developer', 'TypeScript Developer', 'Frontend Developer', 'Backend Developer',
    'Full Stack Developer', 'JavaScript Developer', 'Node.js Developer', 'Web Developer',
    'UI/UX Designer', 'Responsive Design', 'Mobile First', 'Performance Optimization',
    'SEO Specialist', 'Accessibility Expert', 'WCAG Compliance', 'Cross Browser Compatibility',
    'Agile Development', 'Scrum Master', 'Code Review', 'Version Control', 'Git Workflow',
    'API Development', 'REST API', 'GraphQL', 'Database Design', 'PostgreSQL',
    'AWS Cloud', 'Docker Containers', 'CI/CD Pipeline', 'DevOps', 'Vercel Deployment',
    'Astro Framework', 'Next.js', 'Tailwind CSS', 'CSS3', 'HTML5', 'ES6+',
    'React Hooks', 'State Management', 'Component Architecture', 'Testing',
    'Problem Solving', 'Team Collaboration', 'Project Management', 'Client Communication',
    'Spanish Native', 'English Advanced', 'Norwegian Intermediate', 'Multilingual',
    'Santiago Chile', 'Remote Work', 'Freelance', 'Contract Work', 'Available'
];
---

<!DOCTYPE html>
<html lang={lang} class="antialiased">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{t('cv.title')} - {t('site.title')}</title>
    <meta name="description" content={t('about.tldr.description')}>
    <meta name="keywords" content={atsKeywords.join(', ')}>
    
    <!-- Tailwind CSS -->
    <link rel="stylesheet" href="/src/styles/tailwind.config.css">
    <link rel="stylesheet" href="/src/styles/themes.css">
    
    <!-- Print-specific styles -->
    <style>
        @page {
            size: A4;
            margin: 15mm;
        }
        
        /* Theme-aware styling */
        body {
            color: var(--color-main, #000);
            font-family: 'Space Grotesk', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        .a4-page {
            background: var(--color-secondary, #fff);
            color: var(--color-main, #000);
        }
        
        .cv-border {
            border-color: var(--color-main, #000);
        }
        
        .cv-text-primary {
            color: var(--color-main, #000);
        }
        
        .cv-text-secondary {
            color: var(--color-main, #000);
            opacity: 0.7;
        }
        
        .cv-bg-tag {
            background: var(--color-main, #000);
            color: var(--color-secondary, #fff);
        }
        
        /* ATS Keywords - invisible but searchable */
        .ats-keywords {
            position: absolute;
            left: -9999px;
            width: 1px;
            height: 1px;
            overflow: hidden;
            opacity: 0;
            font-size: 1px;
            line-height: 1;
            color: transparent;
        }
        
        @media print {
            .no-print {
                display: none !important;
            }
            
            .print-text {
                display: inline !important;
            }
            
            .print-hide {
                display: none !important;
            }
            
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                font-size: 11px !important;
                background: white !important;
                color: black !important;
            }
            
            .a4-page {
                background: white !important;
                color: black !important;
                box-shadow: none !important;
            }
            
            .cv-border {
                border-color: black !important;
            }
            
            .cv-text-primary {
                color: black !important;
            }
            
            .cv-text-secondary {
                color: #333 !important;
            }
            
            .cv-bg-tag {
                background: black !important;
                color: white !important;
            }
            
            .print-minimal {
                background: white !important;
                border: 1px solid #ccc !important;
                padding: 4px 8px !important;
            }
            
            .print-no-bg {
                background: white !important;
                border: 1px solid #eee !important;
                padding: 8px !important;
            }
            
            .print-light-border {
                border-bottom: 1px solid #ddd !important;
                padding-bottom: 4px !important;
                margin-bottom: 8px !important;
            }
        }
        
        @media screen {
            .print-text {
                display: none;
            }
            
            body {
                background: var(--color-secondary, #f5f5f5);
                padding: 2rem 0;
            }
        }
        
        /* A4 dimensions for screen preview */
        .a4-page {
            width: 210mm;
            min-height: 297mm;
            margin: 0 auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border-radius: 4px;
            overflow: hidden;
        }
        
        /* Social icons */
        .social-icon {
            width: 16px;
            height: 16px;
            display: inline-block;
            vertical-align: middle;
            margin-right: 6px;
        }
        
        /* Smooth transitions for theme changes */
        * {
            transition: color 0.2s ease, background-color 0.2s ease, border-color 0.2s ease;
        }
    </style>
</head>

<body>
    <!-- ATS Keywords (invisible but searchable) -->
    <div class="ats-keywords" aria-hidden="true">
        {atsKeywords.join(' ')}
        Full Stack Web Developer React TypeScript Node.js Astro Tailwind CSS PostgreSQL GraphQL
        Frontend Backend JavaScript ES6 HTML5 CSS3 Responsive Design Mobile First
        Performance Optimization SEO Accessibility WCAG Git GitHub Docker AWS Vercel
        Agile Scrum Code Review API Development REST GraphQL Database Design
        UI UX Design Problem Solving Team Collaboration Project Management
        Spanish English Norwegian Multilingual Santiago Chile Remote Freelance
    </div>
    <!-- Fixed action buttons (no-print) -->
    <div class="no-print fixed bottom-8 right-8 flex flex-col gap-4 z-50">
        <button 
            onclick="window.print()" 
            class="cv-bg-tag px-6 py-3 text-sm font-semibold uppercase tracking-wider hover:opacity-90 transition-opacity rounded-lg shadow-lg"
            aria-label={t('ui.print')}
        >
            {t('ui.print')}
        </button>
        <a 
            href={`/${lang === 'es' ? '' : lang}`} 
            class="bg-white cv-text-primary px-6 py-3 text-sm font-semibold uppercase tracking-wider hover:opacity-90 border-2 cv-border text-center rounded-lg shadow-lg transition-opacity"
        >
            {t('ui.backToHome')}
        </a>
    </div>

    <!-- A4 Page Container -->
    <div class="a4-page p-12">
        <!-- Header with Name and Image -->
        <header class="mb-12 flex justify-between items-start">
            <div class="flex-1 max-w-2xl">
                <h1 class="text-6xl font-bold cv-text-primary mb-3 tracking-tight">{t('site.title')}</h1>
                <h2 class="text-2xl cv-text-secondary mb-8 font-medium">{t('site.subtitle')}</h2>
                
                <!-- Contact Info -->
                <div class="grid grid-cols-2 gap-4 text-sm mb-6">
                    <div class="flex items-center gap-3">
                        <span class="cv-text-primary font-semibold text-base">‚úâ</span>
                        <span class="cv-text-secondary">{t('cv.email')}</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <span class="cv-text-primary font-semibold text-base">üìç</span>
                        <span class="cv-text-secondary">{t('cv.location')}</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <span class="cv-text-primary font-semibold text-base">üåê</span>
                        <span class="cv-text-secondary">{t('cv.website')}</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <span class="cv-text-primary font-semibold text-base">üì±</span>
                        <span class="cv-text-secondary">{t('cv.phone')}</span>
                    </div>
                </div>
                
                <!-- Social Links -->
                <div class="text-sm">
                    <div class="flex flex-wrap gap-6">
                        <div class="flex items-center">
                            <span class="print-hide">
                                <a href="https://linkedin.com/in/skryensya" target="_blank" class="flex items-center cv-text-secondary hover:cv-text-primary transition-colors">
                                    <svg class="social-icon" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                                    </svg>
                                    LinkedIn
                                </a>
                            </span>
                            <span class="print-text cv-text-secondary">LinkedIn: {t('cv.social.linkedin')}</span>
                        </div>
                        <div class="flex items-center">
                            <span class="print-hide">
                                <a href="https://twitter.com/allisonpena_dev" target="_blank" class="flex items-center cv-text-secondary hover:cv-text-primary transition-colors">
                                    <svg class="social-icon" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
                                    </svg>
                                    Twitter
                                </a>
                            </span>
                            <span class="print-text cv-text-secondary">Twitter: {t('cv.social.twitter')}</span>
                        </div>
                        <div class="flex items-center">
                            <span class="print-hide">
                                <a href="https://instagram.com/allisonpena" target="_blank" class="flex items-center cv-text-secondary hover:cv-text-primary transition-colors">
                                    <svg class="social-icon" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 6.618 5.367 11.986 11.988 11.986s11.987-5.368 11.987-11.986C24.004 5.367 18.635.001 12.017.001zM8.449 16.988c-1.297 0-2.448-.49-3.323-1.291a3.435 3.435 0 01-.872-2.319c0-.93.308-1.78.83-2.456a4.473 4.473 0 013.365-1.504c1.297 0 2.448.49 3.323 1.291.872.8 1.322 1.877 1.322 2.973 0 .93-.308 1.78-.83 2.456a4.473 4.473 0 01-3.365 1.504zm7.753-9.021h-1.737c.115-.334.115-.668.115-1.002 0-.334 0-.668-.115-1.002h1.737c.115.334.115.668.115 1.002 0 .334 0 .668-.115 1.002z"/>
                                    </svg>
                                    Instagram
                                </a>
                            </span>
                            <span class="print-text cv-text-secondary">Instagram: {t('cv.social.instagram')}</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Profile Image -->
            <div class="ml-8 flex-shrink-0">
                <div class="w-[120px] h-[120px] rounded-lg overflow-hidden border-2 cv-border">
                    <img src="/images/profile.jpg" alt="Allison Pe√±a Profile Photo" class="w-full h-full object-cover" />
                </div>
            </div>
        </header>


        <!-- Experience -->
        <section class="mb-5">
            <h3 class="text-sm font-bold text-black uppercase tracking-wider mb-3 border-b print-light-border pb-1">{t('cv.experience.title')}</h3>
            
            <div class="space-y-3">
                <div class="border-l print-light-border pl-3">
                    <div class="flex justify-between items-start mb-1">
                        <h4 class="font-bold text-black text-xs">Full-Stack Developer</h4>
                        <span class="text-xs text-gray-600">2021 - Present</span>
                    </div>
                    <p class="text-xs text-gray-700 mb-1">Freelance & Contract Work</p>
                    <ul class="text-xs text-gray-800 space-y-0.5">
                        {lang === 'es' && (
                            <>
                                <li>‚Ä¢ Desarroll√© aplicaciones web accesibles con React, TypeScript y Node.js</li>
                                <li>‚Ä¢ Implement√© soluciones de performance optimization y SEO</li>
                                <li>‚Ä¢ Colabor√© con equipos multidisciplinarios en proyectos de gran escala</li>
                            </>
                        )}
                        {lang === 'en' && (
                            <>
                                <li>‚Ä¢ Developed accessible web applications with React, TypeScript and Node.js</li>
                                <li>‚Ä¢ Implemented performance optimization and SEO solutions</li>
                                <li>‚Ä¢ Collaborated with multidisciplinary teams on large-scale projects</li>
                            </>
                        )}
                        {lang === 'no' && (
                            <>
                                <li>‚Ä¢ Utviklet tilgjengelige webapplikasjoner med React, TypeScript og Node.js</li>
                                <li>‚Ä¢ Implementerte ytelsesoptimalisering og SEO-l√∏sninger</li>
                                <li>‚Ä¢ Samarbeidet med tverrfaglige team p√• store prosjekter</li>
                            </>
                        )}
                    </ul>
                </div>
                
                <div class="border-l print-light-border pl-3">
                    <div class="flex justify-between items-start mb-1">
                        <h4 class="font-bold text-black text-xs">Web Developer</h4>
                        <span class="text-xs text-gray-600">2020 - 2021</span>
                    </div>
                    <p class="text-xs text-gray-700 mb-1">Junior Position</p>
                    <ul class="text-xs text-gray-800 space-y-0.5">
                        {lang === 'es' && (
                            <>
                                <li>‚Ä¢ Mantuve y mejor√© sitios web existentes</li>
                                <li>‚Ä¢ Aprend√≠ mejores pr√°cticas de desarrollo y accessibility</li>
                                <li>‚Ä¢ Particip√© en code reviews y pair programming</li>
                            </>
                        )}
                        {lang === 'en' && (
                            <>
                                <li>‚Ä¢ Maintained and improved existing websites</li>
                                <li>‚Ä¢ Learned development best practices and accessibility</li>
                                <li>‚Ä¢ Participated in code reviews and pair programming</li>
                            </>
                        )}
                        {lang === 'no' && (
                            <>
                                <li>‚Ä¢ Vedlikeholdt og forbedret eksisterende nettsteder</li>
                                <li>‚Ä¢ L√¶rte utviklingspraksis og tilgjengelighet</li>
                                <li>‚Ä¢ Deltok i kodegjennomganger og parprogrammering</li>
                            </>
                        )}
                    </ul>
                </div>
            </div>
        </section>

        <!-- Skills -->
        <section class="mb-5">
            <h3 class="text-sm font-bold text-black uppercase tracking-wider mb-3 border-b print-light-border pb-1">{t('cv.skills.title')}</h3>
            
            <div class="grid grid-cols-3 gap-4">
                <div>
                    <h4 class="font-bold text-black mb-1 text-xs uppercase tracking-wider">{t('cv.skills.frontend')}</h4>
                    <ul class="text-xs text-gray-800 space-y-0.5">
                        <li>React</li>
                        <li>TypeScript</li>
                        <li>Astro</li>
                        <li>Tailwind CSS</li>
                        <li>Next.js</li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="font-bold text-black mb-1 text-xs uppercase tracking-wider">{t('cv.skills.backend')}</h4>
                    <ul class="text-xs text-gray-800 space-y-0.5">
                        <li>Node.js</li>
                        <li>PostgreSQL</li>
                        <li>GraphQL</li>
                        <li>REST APIs</li>
                        <li>Prisma</li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="font-bold text-black mb-1 text-xs uppercase tracking-wider">{t('cv.skills.tools')}</h4>
                    <ul class="text-xs text-gray-800 space-y-0.5">
                        <li>Git & GitHub</li>
                        <li>Docker</li>
                        <li>AWS</li>
                        <li>Vercel</li>
                        <li>Figma</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Tech Stack -->
        <section class="mb-5">
            <h3 class="text-sm font-bold text-black uppercase tracking-wider mb-3 border-b print-light-border pb-1">
                {lang === 'es' && 'Stack Tecnol√≥gico'}
                {lang === 'en' && 'Technology Stack'}
                {lang === 'no' && 'Teknologi Stack'}
            </h3>
            
            <div class="flex flex-wrap gap-2">
                <span class="print-minimal px-2 py-1 text-xs border border-black">React</span>
                <span class="print-minimal px-2 py-1 text-xs border border-black">TypeScript</span>
                <span class="print-minimal px-2 py-1 text-xs border border-black">Node.js</span>
                <span class="print-minimal px-2 py-1 text-xs border border-black">Astro</span>
                <span class="print-minimal px-2 py-1 text-xs border border-black">Tailwind</span>
                <span class="print-minimal px-2 py-1 text-xs border border-black">PostgreSQL</span>
                <span class="print-minimal px-2 py-1 text-xs border border-black">GraphQL</span>
                <span class="print-minimal px-2 py-1 text-xs border border-black">Docker</span>
                <span class="print-minimal px-2 py-1 text-xs border border-black">AWS</span>
                <span class="print-minimal px-2 py-1 text-xs border border-black">Git</span>
            </div>
        </section>

        <!-- Client Projects -->
        <section class="mb-5">
            <h3 class="text-sm font-bold text-black uppercase tracking-wider mb-3 border-b print-light-border pb-1">
                {lang === 'es' && 'Proyectos de Cliente'}
                {lang === 'en' && 'Client Projects'}
                {lang === 'no' && 'Klientprosjekter'}
            </h3>
            
            <div class="space-y-3">
                <div class="border print-light-border p-3 print-no-bg">
                    <h4 class="font-bold text-black mb-1 text-xs">Kit Digital UC</h4>
                    <p class="text-xs text-gray-700 mb-1">
                        {lang === 'es' && 'Plataforma educativa desarrollada con React y Node.js'}
                        {lang === 'en' && 'Educational platform developed with React and Node.js'}
                        {lang === 'no' && 'Utdanningsplattform utviklet med React og Node.js'}
                    </p>
                    <div class="flex flex-wrap gap-1">
                        <span class="print-minimal px-1 py-0.5 text-xs">React</span>
                        <span class="print-minimal px-1 py-0.5 text-xs">TypeScript</span>
                        <span class="print-minimal px-1 py-0.5 text-xs">Node.js</span>
                    </div>
                </div>
                
                <div class="border print-light-border p-3 print-no-bg">
                    <h4 class="font-bold text-black mb-1 text-xs">Portal UC</h4>
                    <p class="text-xs text-gray-700 mb-1">
                        {lang === 'es' && 'Sistema de gesti√≥n acad√©mica con enfoque en accessibility'}
                        {lang === 'en' && 'Academic management system with focus on accessibility'}
                        {lang === 'no' && 'Akademisk administrasjonssystem med fokus p√• tilgjengelighet'}
                    </p>
                    <div class="flex flex-wrap gap-1">
                        <span class="print-minimal px-1 py-0.5 text-xs">Astro</span>
                        <span class="print-minimal px-1 py-0.5 text-xs">React</span>
                        <span class="print-minimal px-1 py-0.5 text-xs">PostgreSQL</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Personal Projects -->
        <section class="mb-5">
            <h3 class="text-sm font-bold text-black uppercase tracking-wider mb-3 border-b print-light-border pb-1">
                {lang === 'es' && 'Proyectos Personales'}
                {lang === 'en' && 'Personal Projects'}
                {lang === 'no' && 'Personlige Prosjekter'}
            </h3>
            
            <div class="space-y-3">
                <div class="border print-light-border p-3 print-no-bg">
                    <h4 class="font-bold text-black mb-1 text-xs">
                        {lang === 'es' && 'Portfolio Personal'}
                        {lang === 'en' && 'Personal Portfolio'}
                        {lang === 'no' && 'Personlig Portef√∏lje'}
                    </h4>
                    <p class="text-xs text-gray-700 mb-1">
                        {lang === 'es' && 'Sitio web personal con dise√±o brutalist y soporte multilenguaje'}
                        {lang === 'en' && 'Personal website with brutalist design and multi-language support'}
                        {lang === 'no' && 'Personlig nettside med brutalistisk design og flerspr√•klig st√∏tte'}
                    </p>
                    <div class="flex flex-wrap gap-1">
                        <span class="print-minimal px-1 py-0.5 text-xs">Astro</span>
                        <span class="print-minimal px-1 py-0.5 text-xs">React</span>
                        <span class="print-minimal px-1 py-0.5 text-xs">Tailwind</span>
                    </div>
                </div>
                
                <div class="border print-light-border p-3 print-no-bg">
                    <h4 class="font-bold text-black mb-1 text-xs">
                        {lang === 'es' && 'Contribuciones Open Source'}
                        {lang === 'en' && 'Open Source Contributions'}
                        {lang === 'no' && 'Open Source Bidrag'}
                    </h4>
                    <p class="text-xs text-gray-700 mb-1">
                        {lang === 'es' && 'Contribuciones a proyectos de c√≥digo abierto y librer√≠as de la comunidad'}
                        {lang === 'en' && 'Contributions to open source projects and community libraries'}
                        {lang === 'no' && 'Bidrag til open source-prosjekter og samfunnsbiblioteker'}
                    </p>
                    <div class="flex flex-wrap gap-1">
                        <span class="print-minimal px-1 py-0.5 text-xs">JavaScript</span>
                        <span class="print-minimal px-1 py-0.5 text-xs">TypeScript</span>
                        <span class="print-minimal px-1 py-0.5 text-xs">Documentation</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Languages -->
        <section class="mb-8">
            <h3 class="text-lg font-bold text-black uppercase tracking-wider mb-4 border-b border-black pb-1">{t('cv.languages.title')}</h3>
            
            <div class="grid grid-cols-3 gap-4">
                <div class="text-sm">
                    <span class="font-bold text-black">{t('cv.languages.spanish')}</span>
                </div>
                <div class="text-sm">
                    <span class="font-bold text-black">{t('cv.languages.english')}</span>
                </div>
                <div class="text-sm">
                    <span class="font-bold text-black">{t('cv.languages.norwegian')}</span>
                </div>
            </div>
        </section>

        <!-- Education -->
        <section>
            <h3 class="text-lg font-bold text-black uppercase tracking-wider mb-4 border-b border-black pb-1">{t('cv.education.title')}</h3>
            
            <div class="border-l-2 border-black pl-4">
                <div class="flex justify-between items-start mb-2">
                    <h4 class="font-bold text-black">
                        {lang === 'es' && 'Autodidacta'}
                        {lang === 'en' && 'Self-Taught'}
                        {lang === 'no' && 'Selvl√¶rt'}
                    </h4>
                    <span class="text-sm text-gray-600">2020 - Present</span>
                </div>
                <p class="text-sm text-gray-700">
                    {lang === 'es' && 'Aprendizaje continuo a trav√©s de recursos online, documentaci√≥n y proyectos pr√°cticos'}
                    {lang === 'en' && 'Continuous learning through online resources, documentation, and hands-on projects'}
                    {lang === 'no' && 'Kontinuerlig l√¶ring gjennom online ressurser, dokumentasjon og praktiske prosjekter'}
                </p>
            </div>
        </section>
    </div>
</body>
</html>